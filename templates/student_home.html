{% extends "base.html" %}

{% block title %}Student Dashboard{% endblock %}

{% block content %}
<div class="student-dashboard">

  <!-- SHARED ALIGNMENT CONTAINER -->
  <div class="dashboard-container">

    <!-- Welcome Banner -->
    <div class="welcome-banner">
      <h1>Welcome back, {{ current_user.first_name }}! ðŸ‘‹</h1>
      <p>Ready to continue your learning journey</p>
    </div>

    <!-- Header Row -->
    <div class="dashboard-header">
      <h2>My Enrolled Courses</h2>
      <a href="{{ url_for('student_join_course') }}" class="join-course-btn">
        + Join Course
      </a>
    </div>

    {% if courses %}
    <!-- Courses Grid -->
    <div class="courses-grid">
      {% for course in courses %}
      <div class="course-card">

        <!-- Card Header -->
        <div class="card-header">
          <h3>{{ course.course_name }}</h3>
          <span class="course-code">{{ course.course_code }}</span>
        </div>

        <!-- Educator -->
        <p class="educator">
          <i data-lucide="user"></i>
          {{ course.educator.first_name }} {{ course.educator.last_name }}
        </p>

        <!-- Description (only if exists) -->
        {% if course.description %}
        <p class="description">
          {{ course.description or 'No description available.' }}
        </p>
        {% endif %}

        <!-- Stats -->
        <div class="stats-row">
          <span class="stat">
            <i data-lucide="book-open"></i>
            {{ course.lesson_plans|length }} Lessons
          </span>
          <span class="stat">
            <i data-lucide="paperclip"></i>
            {% set total_materials = course.lesson_plans
              | map(attribute='materials')
              | map('length')
              | sum %}
            {{ total_materials }} Materials
          </span>
        </div>

        <!-- Actions -->
        <div class="actions">
          <a href="{{ url_for('student_course_lessons', course_id=course.id) }}"
             class="btn-outline">
            View Lessons
          </a>
          <a href="{{ url_for('student_course_materials', course_id=course.id) }}"
             class="btn-outline">
            View Materials
          </a>
        </div>

      </div>
      {% endfor %}
    </div>

    {% else %}
    <!-- Empty State -->
    <div class="empty-state">
      <div class="empty-icon">ðŸ“š</div>
      <h3>No Courses Yet</h3>
      <p>You haven't enrolled in any courses yet.</p>
      <p class="hint">Click the "+ Join Course" button above to get started!</p>
    </div>
    {% endif %}

  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
  if (window.lucide) {
    lucide.createIcons();
  }
});
</script>

{% endblock %}