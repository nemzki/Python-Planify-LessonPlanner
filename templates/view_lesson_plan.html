{% extends "educator_base.html" %}

{% block content %}
<div class="view-plan-wrapper-clean">
    <!-- Header -->
    <div class="view-plan-header-clean">
        <div class="header-left-clean">
            <a href="{{ url_for('course_lesson_plans', course_id=plan.course_id) }}" class="back-icon-btn" title="Back to Lesson Plans">
                <img src="{{ url_for('static', filename='pictures/back-button.png') }}" alt="Back">
            </a>
            <div class="header-titles-clean">
                <h1 class="plan-title-clean">{{ plan.title }}</h1>
                <p class="plan-subtitle-clean">for {{ plan.course.course_name }}</p>
            </div>
        </div>
        <div class="header-actions-clean">
            <a href="{{ url_for('edit_lesson_plan', plan_id=plan.id) }}" class="edit-btn-clean">Edit</a>
            <form method="POST" action="{{ url_for('delete_lesson_plan', plan_id=plan.id) }}"
                  onsubmit="return confirm('Are you sure you want to delete this lesson plan?');" style="display:inline;">
                <button type="submit" class="delete-btn-clean">Delete</button>
            </form>
        </div>
    </div>

    <!-- Main Card -->
    <div class="view-plan-card-clean">
        <!-- Lesson Title Section -->
        <div class="field-section-clean">
            <label class="field-label-clean">Lesson Title</label>
            <p class="field-helper-clean">Main title for this lesson</p>
            <div class="field-value-clean">{{ plan.title }}</div>
        </div>

        <!-- Topic Section -->
        <div class="field-section-clean">
            <label class="field-label-clean">Topic</label>
            <p class="field-helper-clean">Specific topic covered in this lesson</p>
            <div class="field-value-clean">{{ plan.topic or 'N/A' }}</div>
        </div>

        <!-- Learning Objectives Section -->
        <div class="field-section-clean">
            <label class="field-label-clean">Learning Objectives</label>
            <p class="field-helper-clean">What students will learn from this lesson</p>
            <div class="field-value-clean field-value-large-clean">{{ plan.objectives or 'N/A' }}</div>
        </div>

        <!-- Description Section -->
        <div class="field-section-clean">
            <label class="field-label-clean">Description</label>
            <p class="field-helper-clean">Detailed explanation of the lesson content</p>
            <div class="field-value-clean field-value-large-clean">{{ plan.description or 'N/A' }}</div>
        </div>

        <!-- Learning Materials Section -->
        <div class="field-section-clean">
            <label class="field-label-clean">Learning Materials</label>
            <p class="field-helper-clean">Supporting documents and resources</p>
            {% if plan.materials %}
                <ul class="materials-list-clean">
                    {% for material in plan.materials %}
                    <li class="material-item-clean">
                        <div class="material-info-clean">
                            <div class="file-icon-clean">
                                {{ material.filename.split('.')[-1].upper()[:4] }}
                            </div>
                            <a href="{{ url_for('static', filename=material.filepath.replace('static/', '')) }}"
                               target="_blank"
                               class="file-name-clean">{{ material.filename }}</a>
                        </div>
                        <form method="POST"
                              action="{{ url_for('delete_material', material_id=material.id) }}"
                              onsubmit="return confirm('Remove this material?');"
                              style="display:inline;">
                            <button type="submit" class="remove-btn-clean">Remove</button>
                        </form>
                    </li>
                    {% endfor %}
                </ul>
            {% else %}
                <div class="field-value-clean no-materials-clean">No materials uploaded</div>
            {% endif %}
        </div>

        <!-- Metadata Section -->
        <div class="field-section-clean">
            <label class="field-label-clean">Metadata</label>
            <div class="metadata-grid-clean">
                <span class="meta-label-clean">Created:</span>
                <span class="meta-value-clean">{{ plan.created_at.strftime('%B %d, %Y at %I:%M %p') }}</span>

                <span class="meta-label-clean">Last Updated:</span>
                <span class="meta-value-clean">{{ plan.updated_at.strftime('%B %d, %Y at %I:%M %p') }}</span>
            </div>
        </div>
    </div>
</div>
{% endblock %}